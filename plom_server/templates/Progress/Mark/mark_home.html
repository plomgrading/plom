<!--
    SPDX-License-Identifier: AGPL-3.0-or-later
    Copyright (C) 2023 Brennen Chiu
    Copyright (C) 2023-2024 Andrew Rechnitzer
    Copyright (C) 2023, 2025 Colin B. Macdonald
    Copyright (C) 2025 Bryan Tanady
-->
{% extends "base/base.html" %}
{% block title %}
    Marking Progress
{% endblock title %}
{% block page_heading %}
    Marking progress
{% endblock page_heading %}
{% block main_content %}
    {% if user_is_lead_marker or user_is_manager %}
        <div>
            <p>
                <a class="btn btn-primary" href="{% url 'overview_landing' %}">Overview</a>
            </p>
        </div>
    {% endif %}
    {% if missing_task_count > 0 %}
        <div class="container w-100 alert alert-warning">
            There are {{ missing_task_count }} missing tasks.
            {% if user_is_manager %}
                You may want to examine the
                <a class="btn btn-outline-secondary btn-sm align-baseline"
                   href="{% url 'scan_list_incomplete' %}">list of incomplete paper</a>.
            {% else %}
                Use a manager account to examine the list of incomplete papers.
            {% endif %}
        </div>
    {% endif %}
    <div class="container w-100">
        {% for qidx, qlabel, qlabel_html in question_labels_html %}
            <div class="row">
                {% for vn in versions %}
                    <div class="col p-1"
                         hx-trigger="load"
                         hx-get="{% url 'progress_mark_stats' qidx vn %}"></div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
    <div class="container w-100">
        <hr />
        <h4>Testing: same data, all-in-one-view-context</h4>
        {% for qidx, qlabel, qlabel_html in question_labels_html %}
            <div class="row">
                {% for ver in versions %}
                    <div class="col p-1">
                        {% include "Progress/Mark/mark_stats_card.html" with question_idx=qidx question_label_html=qlabel_html version=ver task_status_counts=task_counts|get_item:qidx|get_item:ver histogram_data=data_for_histograms|get_item:qidx|get_item:ver %}
                    </div>
                {% endfor %}
            </div>
        {% endfor %}
    </div>
{% endblock main_content %}
