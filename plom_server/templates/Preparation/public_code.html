<!--
    SPDX-License-Identifier: AGPL-3.0-or-later
    Copyright (C) 2025 Colin B. Macdonald
-->
{% extends "base/base.html" %}
{% block title %}
    Plom server public code
{% endblock title %}
{% block page_heading %}
    Plom server public code
{% endblock page_heading %}
{% block main_content %}
    <div class="mt-2">
        <p>
            The server will only accept scans of pages that match the
            public code (which is embedded in the QR codes on the printed papers.)
        </p>
        <p class="lead m-4">
            Current public code: <tt>{{ public_code }}</tt>
        </p>
        <div class="accordion mt-2" id="reset_accordion">
            <div class="accordion-item">
                <h2 class="accordion-header" id="accordion_heading1">
                    <button class="accordion-button text-bg-danger collapsed"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#collapse1"
                            aria-expanded="false"
                            aria-controls="collapse1">
                        <i class="bi bi-exclamation-triangle-fill"></i> &nbsp;Change the public code
                    </button>
                </h2>
                <div id="collapse1"
                     class="accordion-collapse collapse"
                     aria-labelledby="accordion_heading1"
                     data-bs-parent="#reset_accordion">
                    <div class="accordion-body bg-danger-subtle">
                        <p>
                            One (rare!) reason to change this is to
                            <a class="link-secondary"
                               href="https://plom.readthedocs.io/en/stable/faq.html#how-can-i-clone-a-server-so-that-it-accepts-scans-intended-for-another-server">clone a server</a>,
                            so that it accepts scans intended for another.
                            Maybe you have your own reasons, but be careful!
                        </p>
                        <form enctype="multipart/form-data"
                              id="form"
                              method="post"
                              action="{% url 'public_code' %}">
                            {% csrf_token %}
                            <div class="form-floating m-2">
                                <input type="text"
                                       name="new_public_code"
                                       class="form-control"
                                       id="new_public_code">
                                <label for="new_public_code">New 6-digit public code, or blank to generate a random code</label>
                            </div>
                            <div class="form-check m-2">
                                <input class="form-check-input"
                                       type="checkbox"
                                       role="switch"
                                       id="confirm_check"
                                       value="True"
                                       name="confirm_check"
                                       required>
                                <label class="form-check-label mx-2" for="confirm_check">
                                    I understand that only papers with this precise code can be uploaded to this server.
                                </label>
                            </div>
                            <div>
                                <button class="btn btn-danger" type="submit">Change</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock main_content %}
